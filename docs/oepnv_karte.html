<!DOCTYPE html>
<html>
<head>
    
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css"/>
    
            <meta name="viewport" content="width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
            <style>
                #map_baa0e81d632cb35a9cb78e3eeb8bd53f {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
                .leaflet-container { font-size: 1rem; }
            </style>

            <style>html, body {
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }
            </style>

            <style>#map {
                position:absolute;
                top:0;
                bottom:0;
                right:0;
                left:0;
                }
            </style>

            <script>
                L_NO_TOUCH = false;
                L_DISABLE_3D = false;
            </script>

        
</head>
<body>
    
    
<div style="
    position: fixed; bottom: 14px; left: 14px; z-index: 9999;
    background: rgba(255,255,255,0.95); padding: 8px 10px;
    border: 1px solid #ccc; border-radius: 6px;
    font-family: system-ui, Segoe UI, Arial; font-size: 12px;">
  <div style="font-weight:600; margin-bottom:6px;">Zonen (Entfernung zur Haltestelle)</div>
  
  <div style="display:flex;align-items:center;gap:8px;margin:2px 0;">
    <span style="display:inline-block;width:14px;height:14px;background:#006400;border:1px solid #555"></span>
    <span>bis 150 m</span>
  </div>
  <div style="display:flex;align-items:center;gap:8px;margin:2px 0;">
    <span style="display:inline-block;width:14px;height:14px;background:#2e7d32;border:1px solid #555"></span>
    <span>bis 300 m</span>
  </div>
  <div style="display:flex;align-items:center;gap:8px;margin:2px 0;">
    <span style="display:inline-block;width:14px;height:14px;background:#66bb6a;border:1px solid #555"></span>
    <span>bis 500 m</span>
  </div>
  <div style="display:flex;align-items:center;gap:8px;margin:2px 0;">
    <span style="display:inline-block;width:14px;height:14px;background:#ffd54f;border:1px solid #555"></span>
    <span>bis 750 m</span>
  </div>
  <div style="display:flex;align-items:center;gap:8px;margin:2px 0;">
    <span style="display:inline-block;width:14px;height:14px;background:#fb8c00;border:1px solid #555"></span>
    <span>bis 1000 m</span>
  </div>
</div>
    
<script>
document.addEventListener("DOMContentLoaded", function() {
  var map = map_baa0e81d632cb35a9cb78e3eeb8bd53f;

  var COLORS   = {"150": "#006400", "300": "#2e7d32", "500": "#66bb6a", "750": "#ffd54f", "1000": "#fb8c00"};
  var OPACITY  = {"1000": 0.35, "750": 0.4, "500": 0.48, "300": 0.52, "150": 0.55};

  var baseLayers = {};
  var overlays   = {};

  var layerControl = L.control.layers(baseLayers, overlays, {collapsed: false}).addTo(map);

  function zoneStyle(dist) {
    var c  = COLORS[dist] || "#999999";
    var op = OPACITY[dist] || 0.5;
    return function(feature) {
      return {
        color: c,
        weight: 0.7,
        fillColor: c,
        fillOpacity: op
      };
    };
  }

  function saStyle(dist) {
    var c = COLORS[dist] || "#999999";
    return function(feature) {
      return {
        color: c,
        weight: 2.0,
        fillOpacity: 0.0,
        dashArray: "6,4"
      };
    };
  }

  // Zonen (groß -> klein, damit 150 m oben liegt)
  var zoneFiles = {"1000": "zone_1000.geojson", "750": "zone_750.geojson", "500": "zone_500.geojson", "300": "zone_300.geojson", "150": "zone_150.geojson"};
  Object.keys(zoneFiles).forEach(function(distStr) {
    var dist = parseInt(distStr);
    var url  = zoneFiles[distStr];
    fetch(url).then(r => r.json()).then(function(data) {
      var layer = L.geoJson(data, {
        style: zoneStyle(dist),
        smoothFactor: 0.5
      });
      var label = "bis " + dist + " m";
      layer.addTo(map);
      overlays[label] = layer;
      layerControl.addOverlay(layer, label);
    });
  });

  // Service-Areas (nur Umriss)
  var saFiles = {};
  Object.keys(saFiles).forEach(function(distStr) {
    var dist = parseInt(distStr);
    var url  = saFiles[distStr];
    fetch(url).then(r => r.json()).then(function(data) {
      var layer = L.geoJson(data, {
        style: saStyle(dist),
        smoothFactor: 0.5
      });
      var label = "Service Area ÖPNV bis " + dist + " m";
      overlays[label] = layer;
      layerControl.addOverlay(layer, label);
    });
  });

  // Wohngebäude (Umriss)
  var bldgFile = "wohngebaeude_oepnv.geojson";
  if (bldgFile) {
    fetch(bldgFile).then(r => r.json()).then(function(data) {
      var layer = L.geoJson(data, {
        style: function(feature) {
          return { color: "#000000", weight: 0.4, fillOpacity: 0.0 };
        },
        smoothFactor: 0.3
      });
      overlays["Wohngebäude"] = layer;
      layer.addTo(map);
      layerControl.addOverlay(layer, "Wohngebäude");
    });
  }

  // Haltestellen
  var halteFile = "oepnv_haltestellen.geojson";
  if (halteFile) {
    fetch(halteFile).then(r => r.json()).then(function(data) {
      var layer = L.geoJson(data, {
        pointToLayer: function(feature, latlng) {
          return L.circleMarker(latlng, {
            radius: 3,
            color: "#0044ff",
            weight: 1,
            fill: true,
            fillColor: "#0044ff",
            fillOpacity: 0.9
          });
        },
        onEachFeature: function(feature, lyr) {
          var props = feature.properties || {};
          var tt = props.name || props.halte_name || props.bezeichnung;
          if (tt) lyr.bindTooltip(tt);
        }
      });
      overlays["ÖPNV-Haltestellen"] = layer;
      layer.addTo(map);
      layerControl.addOverlay(layer, "ÖPNV-Haltestellen");
    });
  }

  // Stadtbezirke mit Popup
  var ergFile      = "oepnv_ergebnis.geojson";
  var popupFields  = ["STADTBZNAM", "wohn_total", "zone150", "zone300", "zone500", "zone750", "zone1000", "pro_150", "pro_300", "pro_500", "pro_750", "pro_1000"];
  var popupAliases = ["Bezirk", "Wohngeb\u00e4ude ges.", "Zone 150", "Zone 300", "Zone 500", "Zone 750", "Zone 1000", "Pro 150 (%)", "Pro 300 (%)", "Pro 500 (%)", "Pro 750 (%)", "Pro 1000 (%)"];
  var bezField     = "STADTBZNAM";

  fetch(ergFile).then(r => r.json()).then(function(data) {
    var layer = L.geoJson(data, {
      style: function(feature) {
        return { color: "#444444", weight: 1.2, fillOpacity: 0.0 };
      },
      onEachFeature: function(feature, lyr) {
        var props = feature.properties || {};
        var bez = props[bezField] || "(Bezirk)";
        lyr.bindTooltip("Bezirk: " + bez, {sticky:false});

        var html = '<div style="font-family:system-ui,Segoe UI,Arial;font-size:13px;line-height:1.35;min-width:260px;">';
        html += '<div style="font-weight:700;margin-bottom:6px;">' + bez + '</div>';
        html += '<table style="border-collapse:collapse;width:100%;">';

        for (var i=0; i<popupFields.length; i++) {
          var fld   = popupFields[i];
          var alias = popupAliases[i] || fld;
          var val   = props[fld];
          if (val === undefined || val === null) val = '';
          html += '<tr><td style="padding:3px 6px;border-bottom:1px solid #e5e7eb;">' + alias + '</td>';
          html += '<td style="padding:3px 6px;text-align:right;border-bottom:1px solid #e5e7eb;">' + val + '</td></tr>';
        }
        html += '</table></div>';
        lyr.bindPopup(html, {maxWidth: 520});
      }
    });
    overlays["Stadtbezirke (ÖPNV-Ergebnis)"] = layer;
    layer.addTo(map);
    layerControl.addOverlay(layer, "Stadtbezirke (ÖPNV-Ergebnis)");
  });

});
</script>
    
            <div class="folium-map" id="map_baa0e81d632cb35a9cb78e3eeb8bd53f" ></div>
        
</body>
<script>
    
    
            var map_baa0e81d632cb35a9cb78e3eeb8bd53f = L.map(
                "map_baa0e81d632cb35a9cb78e3eeb8bd53f",
                {
                    center: [52.37960838250007, 9.761552823000061],
                    crs: L.CRS.EPSG3857,
                    ...{
  "zoom": 12,
  "zoomControl": true,
  "preferCanvas": false,
}

                }
            );
            L.control.scale().addTo(map_baa0e81d632cb35a9cb78e3eeb8bd53f);

            

        
    
            var tile_layer_0899925e71c6c67a06f5d3c0ec169435 = L.tileLayer(
                "https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",
                {
  "minZoom": 0,
  "maxZoom": 20,
  "maxNativeZoom": 20,
  "noWrap": false,
  "attribution": "\u0026copy; \u003ca href=\"https://www.openstreetmap.org/copyright\"\u003eOpenStreetMap\u003c/a\u003e contributors \u0026copy; \u003ca href=\"https://carto.com/attributions\"\u003eCARTO\u003c/a\u003e",
  "subdomains": "abcd",
  "detectRetina": false,
  "tms": false,
  "opacity": 1,
}

            );
        
    
            tile_layer_0899925e71c6c67a06f5d3c0ec169435.addTo(map_baa0e81d632cb35a9cb78e3eeb8bd53f);
        
</script>
</html>